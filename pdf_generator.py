from fpdf import FPDF

class PDF(FPDF):
    def header(self):
        # Logo
        self.image('static/logo.png', x=10, y=8, w=30)
        self.set_font('Arial', 'B', 16)  # Larger font for the title
        self.set_text_color(0, 51, 153)  # Dark blue for the title
        self.cell(0, 10, 'Cardiovascular Disease Prediction Report', 0, 1, 'C')
        
        # Subtitle with contact information
        self.set_font('Arial', 'I', 12)
        self.set_text_color(128, 128, 128)  # Grey text for the subtitle
        self.cell(0, 10, 'For more information visit Wise Wellness or call +91 xxxxxxxxxxx', 0, 1, 'C')
        self.ln(10)

    def chapter_title(self, title):
        self.set_font('Arial', 'B', 12)
        self.set_text_color(0, 51, 153)  # Dark blue for section titles
        self.cell(0, 10, title, 0, 1, 'L')
        self.ln(5)

    def chapter_body(self, body, title=None):
        # Body content with light blue background for title
        self.set_font('Arial', 'B', 12)
        self.set_fill_color(200, 220, 255)  # Light blue background
        if title:
            self.cell(0, 10, title, 0, 1, 'L', 1)
            self.ln(5)
        self.set_font('Arial', '', 12)
        self.set_text_color(0, 0, 0)  # Reset text color to black
        self.multi_cell(0, 10, body)
        self.ln()

    def footer(self):
        self.set_y(-15)
        self.set_font('Arial', 'I', 8)
        self.set_fill_color(0, 0, 0)  # Black background for the footer
        self.set_text_color(255, 255, 255)  # White text for footer
        self.cell(0, 10, 'Generated by Cardiovascular Disease Prediction System', 0, 0, 'C', 1)

def generate_pdf(name, age, gender, phone, chestpain, restingBP, serumcholestrol, fastingbloodsugar, maxheartrate, file_path):
    pdf = PDF()
    pdf.add_page()
    
    # Added light gray background
    pdf.set_font('Arial', 'B', 12)
    pdf.set_text_color(0, 51, 153)  # Dark blue for 'Patient Information' title
    pdf.cell(0, 10, 'Patient Information:', 0, 1, 'L')
    pdf.ln(5)
    
    # Border and background around patient information
    pdf.set_fill_color(240, 240, 240)  # Light gray background
    pdf.rect(x=10, y=pdf.get_y(), w=190, h=40, style='F')
    
    # Patient Information inside the box
    pdf.set_xy(12, pdf.get_y() + 2)  # Adjust starting position inside the box
    pdf.set_font('Arial', '', 12)
    pdf.set_text_color(0, 0, 0)  # Reset text color to black
    pdf.cell(0, 9, f"Name: {name}", ln=True)
    pdf.cell(0, 10, f"Age: {age}", ln=True)
    pdf.cell(0, 10, f"Gender: {'Male' if gender == 1 else 'Female'}", ln=True)
    pdf.cell(0, 10, f"Phone Number: {phone}", ln=True)
    
    pdf.ln(10)
    
    # Section title for testing results
    pdf.chapter_title('Testing Results:')
    
    # Display test results in an organized manner
    results = (
        f"Chest Pain: {chestpain}\n"
        f"Resting Blood Pressure: {restingBP} mmHg\n"
        f"Serum Cholesterol: {serumcholestrol} mg/dL\n"
        f"Fasting Blood Sugar: {fastingbloodsugar} mg/dL\n"
        f"Max Heart Rate: {maxheartrate} bpm\n"
    )
    
    pdf.chapter_body(results, title='Test Results')
    
    # Thank you message
    pdf.ln(10)
    pdf.set_font('Arial', 'I', 12)
    pdf.set_text_color(0, 51, 153)  
    pdf.cell(0, 10, 'Thank you for your support.', 0, 1, 'C')
    
    pdf.output(file_path)

